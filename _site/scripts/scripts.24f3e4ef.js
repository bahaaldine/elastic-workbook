"use strict";angular.module("workbookApp",["ngAnimate","ngCookies","ngResource","ui.router","ngSanitize","ngTouch","ngMaterial","ngAria","infinite-scroll","elasticsearch","hljs","ngOdometer","workbook.controllers","workbook.filters","workbook.elasticsearch","workbook.menu","workbook.demos"]).config(["$stateProvider","$urlRouterProvider","$logProvider",function(a,b){b.otherwise("/"),a.state("home",{url:"/",title:"Getting started"}).state("home.demos",{url:"/demos","abstract":!0}).state("home.demos.text",{url:"/demos/text","abstract":!0}).state("home.demos.text.fulltextsearch",{url:"/demos/text/fulltextsearch",title:"Full text search demo",views:{"@":{templateUrl:"views/demos/fulltextsearch/index.html"}}}).state("home.demos.text.fuzzysearch",{url:"/demos/text/fuzzysearch",title:"Fuzzy search demo",views:{"@":{templateUrl:"views/demos/fuzzysearch/index.html"}}}).state("home.demos.text.typeahead",{url:"/demos/text/typeahead",title:"Type ahead demo",views:{"@":{templateUrl:"views/demos/typeahead/index.html"}}}).state("home.demos.text.didyoumean",{url:"/demos/text/didyoumean",title:"Did you mean demo",views:{"@":{templateUrl:"views/demos/didyoumean/index.html"}}}).state("home.demos.geo",{url:"/demos/geo","abstract":!0}).state("home.demos.geo.geoshapes",{url:"/demos/geo/geoshapes",title:"Geoshapes demo",views:{"@":{templateUrl:"views/demos/geoshapes/index.html"}}}).state("home.demos.geo.dragthemap",{url:"/demos/geo/dragthemap",title:"Drag the map demo",views:{"@":{templateUrl:"views/demos/dragthemap/index.html"}}}).state("home.demos.faceted",{url:"/demos/faceted","abstract":!0}).state("home.demos.faceted.simpleaggregation",{url:"/demos/faceted/simpleaggregation",title:"Simple aggregation demo",views:{"@":{templateUrl:"views/demos/simpleaggregation/index.html"}}})}]).config(["$mdThemingProvider",function(a){var b=a.extendPalette("teal",{500:"39bdb1"});a.definePalette("elastic",b),a.theme("default").primaryPalette("elastic").accentPalette("amber")}]),angular.module("workbook.filters",[]).filter("nospace",function(){return function(a){return a?a.replace(/ /g,""):""}}).filter("humanizeDoc",function(){return function(a){return a?"directive"===a.type?a.name.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()}):a.label||a.name:void 0}}),function(){angular.module("workbook.controllers",[]).controller("workbookCtrl",["$scope","$log","$state","$timeout","$location","menu",function(a,b,c,d,e,f){function g(a){return f.isSectionSelected(a)}function h(a){f.toggleSelectSection(a)}function i(a){var b=!1,c=f.openedSection;return c===a?b=!0:a.children&&a.children.forEach(function(a){a===c&&(b=!0)}),b}var j=this;j.isOpen=g,j.toggleOpen=h,j.isSectionSelected=i,j.autoFocusContent=!1,j.menu=f,j.status={isFirstOpen:!0,isFirstDisabled:!1},a.vm=j,a.$state=c}])}(),angular.module("workbook.elasticsearch.factories",[]).service("es",["esFactory",function(a){return a({host:"bahaaldine:bazarmi@localhost:9200",log:"warning"})}]).factory("ESClient",["$q","es",function(a,b){var c=function(a,b){this.pageSize=a,this.from=b,this.more=!0};return c.prototype.nextPage=function(a){this.request=a,angular.isDefined(this.response)||(this.response=[]),!this.busy&&this.more&&(this.busy=!0,angular.isDefined(this.from)&&(a.body.from=this.from),angular.isDefined(this.pageSize)&&(a.body.size=this.pageSize),b.search(a).then(function(a){this.from+=a.hits.hits.length-1,this.more=this.pageSize===a.hits.hits.length,this.response=this.response.concat(a.hits.hits),this.busy=!1,this.total=a.hits.total}.bind(this),function(a){console.trace(a.message)}))},c}]),angular.module("workbook.elasticsearch",["workbook.elasticsearch.factories"]),angular.module("workbook.menu.directives",[]).directive("menuToggle",["$timeout",function(a){return{scope:{section:"="},templateUrl:"partials/menu-toggle.tmpl.html",link:function(a,b){var c=b.parent().controller();a.isOpen=function(){return c.isOpen(a.section)},a.toggle=function(){c.toggleOpen(a.section)}}}}]).directive("menuLink",function(){return{scope:{section:"="},templateUrl:"partials/menu-link.tmpl.html",link:function(a,b){var c=b.parent().controller();a.focusSection=function(){c.autoFocusContent=!0}}}}),angular.module("workbook.menu.factories",[]).factory("menu",["$location",function(a){var b=[{name:"Getting Started",state:"home",type:"link"}];b.push({name:"Text search",type:"toggle",pages:[{name:"Full text search",type:"link",state:"home.demos.text.fulltextsearch",icon:"fa fa-globe"},{name:"Fuzzy search",type:"link",state:"home.demos.text.fuzzysearch",icon:"fa fa-globe"},{name:"Type ahead",type:"link",state:"home.demos.text.typeahead",icon:"fa fa-globe"},{name:"Did you mean",type:"link",state:"home.demos.text.didyoumean",icon:"fa fa-globe"}]}),b.push({name:"Geo search",type:"toggle",pages:[{name:"Geoshapes",type:"link",state:"home.demos.geo.geoshapes",icon:"fa fa-globe"},{name:"Drag the map",type:"link",state:"home.demos.geo.dragthemap",icon:"fa fa-globe"}]}),b.push({name:"Faceted search",type:"toggle",pages:[{name:"Simple aggregation",type:"link",state:"home.demos.faceted.simpleaggregation",icon:"fa fa-globe"}]});var c;return c={sections:b,toggleSelectSection:function(a){c.openedSection=c.openedSection===a?null:a},isSectionSelected:function(a){return c.openedSection===a},selectPage:function(b,d){d&&d.url&&a.path(d.url),c.currentSection=b,c.currentPage=d}}}]),angular.module("workbook.menu",["workbook.menu.directives","workbook.menu.factories"]),function(){angular.module("workbook.demos.geoshapes",[]).directive("polygonMap",["ESClient","$parse",function(a,b){return{restrict:"EA",replace:!0,link:function(a,b,c){a.deleteSelectedShape=function(){a.selectedShape.setMap(null)},a.getPolygonCoordinates=function(b){for(var c=b.getPath(),d=[],e=0;e<c.getLength();e++){var f=c.getAt(e);d.push({lat:f.lat(),lon:f.lng()})}a.$apply(function(){a.edges=d})},a.handlePolygon=function(b){a.selectedShape=b,a.getPolygonCoordinates(b),a.drawingManager.setDrawingMode(null)},a.map=new google.maps.Map(b[0],{center:{lat:48.8567,lng:2.3508},zoom:12}),a.drawingManager=new google.maps.drawing.DrawingManager({drawingMode:google.maps.drawing.OverlayType.MARKER,drawingControl:!0,drawingControlOptions:{position:google.maps.ControlPosition.TOP_CENTER,drawingModes:[google.maps.drawing.OverlayType.POLYGON]},polygonOptions:{fillColor:"#2196F3",fillOpacity:.2,strokeWeight:5,strokeColor:"#1565C0",clickable:!0,zIndex:1}}),a.drawingManager.setMap(a.map),a.drawingManager.addListener("polygoncomplete",a.handlePolygon),google.maps.event.addListener(a.map,"click",a.deleteSelectedShape)},controller:["$scope",function(c){var d="";c.toPrettyJSON=function(a,c){var e=JSON.stringify(a),f=null;try{f=b(e)({})}catch(g){return d}var h=JSON.stringify(f,null,Number(c));return d=h,h},c.$watch("edges",function(b){angular.isDefined(c.edges)&&(c.esClient=new a(10,0),c.geoshapeRequest={index:"accident*",type:"accident",body:{from:c.from,size:c.pageSize,query:{filtered:{query:{match_all:{}},filter:{geo_polygon:{location:{points:c.edges}}}}}}},c.esClient.nextPage(c.geoshapeRequest))},!0)}]}}])}(),angular.module("workbook.demos",["workbook.demos.geoshapes"]);